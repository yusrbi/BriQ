# -*- coding: utf-8 -*-

import utils, document, table, sentence_processor

from extractor import FeatureExtractor 

feature_extractor = FeatureExtractor(5)

text= '2012 Financial Results Premium Revenue (in billions) Operating Results Total premium revenue was $15.4 billion for 2012, an increase of 5 percent from 2011. Premium revenue from life insurance increased 4 percent during 2012 and included a 4 percent increase in renewal premiums from inforce policies. Annuity premium increased 12 percent from 2011, while premium revenue for disability and long-term care insurance increased 5 percent and 29 percent, respectively'
table_html = """ <table>      <thead>        <tr>          <th>Year ended December 31:</th>          <th>2012</th>          <th class="last">2011</th>        </tr>      </thead>      <tbody>        <tr>          <td>Premiums</td>          <td>$15,394</td>          <td class="last">$14,618</td>        </tr>        <tr>          <td>Net investment income</td>          <td>8,677</td>          <td class="last">8,439</td>        </tr>        <tr>          <td>Other income</td>          <td>550</td>          <td class="last">538</td>        </tr>        <tr class="totals">          <td>Total revenue</td>          <td>24,621</td>          <td class="last">23,595</td>        </tr>        <tr>          <td>Policyowner benefits paid</td>          <td>7,302</td>          <td class="last">7,074</td>        </tr>        <tr>          <td>Increase in benefit reserves</td>          <td>9,053</td>          <td class="last">8,430</td>        </tr>        <tr>          <td>Commissions and expenses</td>          <td>2,609</td>          <td class="last">2,437</td>        </tr>        <tr class="totals">          <td>Total benefits and expenses</td>          <td>18,964</td>          <td class="last">17,941</td>        </tr>        <tr class="totals">          <td>Gain before dividends and taxes</td>          <td>5,657</td>          <td class="last">5,654</td>        </tr>        <tr class="totals">          <td>Policyowner dividends</td>          <td>5,045</td>          <td class="last">4,973</td>        </tr>        <tr>          <td>Gain before taxes</td>          <td>612</td>          <td class="last">681</td>        </tr>        <tr>          <td>Income tax expense</td>          <td>37</td>          <td class="last">6</td>        </tr>        <tr class="totals">          <td>Net gain from operations</td>          <td>575</td>          <td class="last">675</td>        </tr>        <tr>          <td>Net realized capital gains (losses)</td>          <td>208</td>          <td class="last">(30)</td>        </tr>        <tr class="totals">          <td>Net income</td>          <td>$783</td>          <td class="last">$645</td>        </tr>      </tbody>    </table>    """

text = "Funds flow for 2012 was approximately $1.25 billion ($2.62 per share - basic) compared to $1.54 billion ($3.29 per share - basic) in 2011. The decline in funds flow was primarily attributed to lower commodity price realizations from wider Canadian crude oil differentials and lower natural gas prices"

table_html = '''<table border="0" cellspacing="0">    <tr valign="top">    <td align="left" class="cnwUnderlinedCell" rowspan="2" valign="bottom">    (millions, except per share amounts)    </td>    <td align="right" class="cnwUnderlinedCell" colspan="4" nowrap="nowrap">    Three months ended<br/>     December 31    </td>    <td align="right" class="cnwUnderlinedCell" colspan="4" nowrap="nowrap">    Year ended<br/>     December 31    </td>    </tr>    <tr valign="top">    <td align="right" class="cnwUnderlinedCell" colspan="2">    <b>2012</b>    </td>    <td align="right" class="cnwUnderlinedCell" colspan="2">    2011    </td>    <td align="right" class="cnwUnderlinedCell" colspan="2">    <b>2012</b>    </td>    <td align="right" class="cnwUnderlinedCell" colspan="2">    2011    </td>    </tr>    <tr valign="top">    <td align="left">    Cash flow from operating activities    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>441</b>    </td>    <td align="right">    $    </td>    <td align="right">    484    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>1,193</b>    </td>    <td align="right">    $    </td>    <td align="right">    1,407    </td>    </tr>    <tr valign="top">    <td align="left">    Increase (decrease) in non-cash working capital    </td>    <td align="right">    &#160;    </td>    <td align="right">    <b>(178)</b>    </td>    <td align="right">    &#160;    </td>    <td align="right">    &#160;&#160;&#160;&#160; (83)    </td>    <td align="right">    &#160;    </td>    <td align="right">    <b>(37)</b>    </td>    <td align="right">    &#160;    </td>    <td align="right">    49    </td>    </tr>    <tr class="cnwUnderlinedCell" valign="top">    <td align="left">    Decommissioning expenditures    </td>    <td align="right">    &#160;    </td>    <td align="right">    <b>32</b>    </td>    <td align="right">    &#160;    </td>    <td align="right">    36    </td>    <td align="right">    &#160;    </td>    <td align="right">    <b>92</b>    </td>    <td align="right">    &#160;    </td>    <td align="right">    81    </td>    </tr>    <tr class="cnwUnderlinedCell" valign="top">    <td align="left">    Funds flow    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>295</b>    </td>    <td align="right">    $    </td>    <td align="right">    437    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>1,248</b>    </td>    <td align="right">    $    </td>    <td align="right">    1,537    </td>    </tr>    <tr valign="top">    <td align="left">    &#160;    </td>    <td align="right">    &#160;    </td>    <td align="right">    &#160;    </td>    <td align="right">    &#160;&#160;&#160;&#160;    </td>    <td align="right">    &#160;    </td>    <td align="right">    &#160;&#160;&#160;&#160;    </td>    <td align="right">    &#160;    </td>    <td align="right">    &#160;&#160;&#160;&#160;    </td>    <td align="right"> &#160; </td>  </tr>    <tr valign="top">    <td align="left">    Basic per share    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>0.62</b>    </td>    <td align="right">    $    </td>    <td align="right">    0.93    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>2.62</b>    </td>    <td align="right">    $    </td>    <td align="right">    3.29    </td>    </tr>    <tr class="cnwUnderlinedCell" valign="top">    <td align="left">    Diluted per share    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>0.62</b>    </td>    <td align="right">    $    </td>    <td align="right">    0.93    </td>    <td align="right">    <b>$</b>    </td>    <td align="right">    <b>2.62</b>    </td>    <td align="right">    $    </td>    <td align="right">    3.29    </td>    </tr>    </table> '''

text = u"Lending for buy-to-let increased marginally in September with 14,600 buy-to-let loans advanced, which was up 0.7% in volume compared to August. The value of these loans totalled Â£1.9bn, which was unchanged from August."


table_html = '''<table class="wysiwyg" style="width: 611px; height: 125px;" border="0" cellpadding="2">&#13;  <tbody>&#13;  <tr align="center" valign="top">&#13;  <td>&#160;</td>&#13;  <td><strong><span style="background-color: #e5e9e8;"><span>&#160;Number of Gross BTL advances in period</span></span></strong></td>&#13;  <td><strong><span style="background-color: #e5e9e8;"><span>Value of Gross BTL&#160;advances, &#163;m&#160;&#160;</span></span></strong></td>&#13;  <td><strong><span style="background-color: #e5e9e8;"><span>Number of&#160;BTL house purchase </span>loans</span></strong></td>&#13;  <td><strong><span style="background-color: #e5e9e8;"><span>Value of</span> BTL house purchase loans, &#163;m</span></strong></td>&#13;  <td><strong><span style="background-color: #e5e9e8;"><span>Number of BTL &#160;<br/> </span>remortgage loans</span></strong></td>&#13;  <td><strong><span style="background-color: #e5e9e8;"><span>Value of&#160;BTL remortgage<br/> </span>loans, &#163;m</span></strong></td>&#13;  </tr>&#13;  <tr align="center">&#13;  <td>September<br/> 2013</td>&#13;  <td>14,600</td>&#13;  <td>1,900</td>&#13;  <td>7,640</td>&#13;  <td>870</td>&#13;  <td>6,850</td>&#13;  <td>990</td>&#13;  </tr>&#13;  <tr align="center">&#13;  <td>Change from<br/> August&#160;2013</td>&#13;  <td>0.7%</td>&#13;  <td>0.0%</td>&#13;  <td>-0.5%</td>&#13;  <td>0.0%</td>&#13;  <td>1.6%</td>&#13;  <td>3.1%</td>&#13;  </tr>&#13;  </tbody>&#13;  </table>&#13; '''

table_html = u'''<table border="1" cellspacing="0" cellpadding="0" class="prnsbb1 prnsbl1 prnsbt1 prnsbr1"><tr>&#13; <td colspan="10" class="prngen4">&#13; <p class="prnews_p"><span class="prnews_span"><b>ISM&#174; NON-MANUFACTURING SURVEY RESULTS AT A GLANCE<br/> COMPARISON OF ISM&#174; NON-MANUFACTURING AND ISM&#174; MANUFACTURING SURVEYS*<br/> JUNE 2014</b></span></p>&#13; </td></tr>&#13; <tr>&#13; <td colspan="10" class="prngen4"><br/> </td></tr>&#13; <tr>&#13; <td rowspan="2" class="prngen5">&#13; <p class="prnews_p"><span class="prnews_span">Index</span></p>&#13; </td>&#13; <td colspan="6" class="prngen6">&#13; <p class="prntac"><span class="prnews_span"><b>Non-Manufacturing</b></span></p>&#13; </td>&#13; <td colspan="3" class="prngen6">&#13; <p class="prntac"><span class="prnews_span"><b>Manufacturing</b></span></p>&#13; </td></tr>&#13; <tr>&#13; <td nowrap="nowrap" class="prngen5">&#13; <p class="prntac"><span class="prnews_span">Series<br/> Index <br/> Jun</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Series Index </span><span class="prnews_span">May</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Percent Point Change</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">Direction</span></p>&#13; </td>&#13; <td nowrap="nowrap" class="prngen5">&#13; <p class="prntac"><span class="prnews_span">Rate of </span><span class="prnews_span">Change</span></p>&#13; </td>&#13; <td nowrap="nowrap" class="prngen5">&#13; <p class="prntac"><span class="prnews_span">Trend**</span><span class="prnews_span">(Months)</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Series Index </span><span class="prnews_span">Jun</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Series Index </span><span class="prnews_span">May</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Percent Point Change</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>NMI<i><sup>&#174;</sup></i>/PMI<i><sup>&#174;</sup></i></b></span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">56.0</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">56.3</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">-0.3</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">53</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">55.3</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">55.4</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">-0.1</span></p>&#13; </td></tr>&#13; <tr>&#13; <td nowrap="nowrap" class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Business Activity/</b></span></p>&#13; &#13; <p class="prnews_p"><span class="prnews_span"><b>&#160; Production</b></span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">57.5</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">62.1</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">-4.6</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">59</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">60.0</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">61.0</span></p>&#13; </td>&#13; <td class="prngen5">&#13; <p class="prntac"><span class="prnews_span">-1.0</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>New Orders</b></span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">61.2</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">60.5</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">+0.7</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Faster</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">59</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">58.9</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">56.9</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">+2.0</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Employment</b></span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">54.4</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">52.4</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">+2.0</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Faster</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">4</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">52.8</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">52.8</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">0.0</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Supplier Deliveries</b></span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">51.0</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">50.0</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">+1.0</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">Slowing</span></p>&#13; </td>&#13; <td nowrap="nowrap" class="prngen4">&#13; <p class="prntac"><span class="prnews_span">From Unchanged</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">1</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">51.9</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">53.2</span></p>&#13; </td>&#13; <td class="prngen4">&#13; <p class="prntac"><span class="prnews_span">-1.3</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Inventories</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">53.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">55.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-2.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">3</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">53.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">53.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">0.0</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Prices</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">61.2</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">61.4</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-0.2</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Increasing</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">57</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">58.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">60.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-2.0</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Backlog of Orders</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">53.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">54.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-1.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">2</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">48.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">52.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-4.5</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>New Export Orders</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">55.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">53.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">+2.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Faster</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">3</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">54.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">56.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-2.0</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Imports</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">53.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">55.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-2.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Growing</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">4</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">57.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">54.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">+2.5</span></p>&#13; </td></tr>&#13; <tr>&#13; <td class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Inventory Sentiment</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">60.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">63.0</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">-2.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Too High</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">Slower</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">205</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td></tr>&#13; <tr>&#13; <td nowrap="nowrap" class="prngen6">&#13; <p class="prnews_p"><span class="prnews_span"><b>Customers' Inventories</b></span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">N/A</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">46.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">46.5</span></p>&#13; </td>&#13; <td class="prngen6">&#13; <p class="prntac"><span class="prnews_span">0.0</span></p>&#13; </td></tr></table>'''

text= u"""Inventory SentimentThe ISMÂ® Non-Manufacturing Inventory Sentiment Index for June registered 60.5 percent, which is 2.5 percentage points lower than the 63 percent reported in May. This indicates that respondents believe their inventories are still too high at this time. In June, 25 percent of respondents said their inventories were too high, 4 percent said their inventories were too low, and 71 percent said their inventories were about right"""
table_html = u'''<table cellpadding="0" cellspacing="6" class="gnw_table">&#13; &#13; &#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label">&#13; &#13;     &#160;</td>&#13; &#13;    <td class="gnw_colhead_uline " colspan="2">&#13; &#13;     <strong>Three Months Ended <chron>June 30</chron>,</strong></td>&#13; &#13;    <td class="gnw_colhead_uline " colspan="2">&#13; &#13;     <strong>Six Months Ended <chron>June 30</chron>,</strong></td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label">&#13; &#13;     &#160;</td>&#13; &#13;    <td class="gnw_colhead_uline">&#13; &#13;     <strong>2013</strong></td>&#13; &#13;    <td class="gnw_colhead_uline">&#13; &#13;     <strong>2012</strong></td>&#13; &#13;    <td class="gnw_colhead_uline">&#13; &#13;     <strong>2013</strong></td>&#13; &#13;    <td class="gnw_colhead_uline">&#13; &#13;     <strong>2012</strong></td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label">&#13; &#13;     <strong>&#160;</strong></td>&#13; &#13;    <td class="gnw_colhead " colspan="4">&#13; &#13;     <strong>(In thousands)</strong></td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label">&#13; &#13;     <strong>Net loss from continuing operations</strong></td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     $&#160;(14,885)</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     $&#160;(18,029)</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     <money>$ (32,124)</money></td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     $&#160;(31,289)</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Income tax expense</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     341</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;8</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;767</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;&#160;87</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Depreciation and amortization expense</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;5,503</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;5,188</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     11,152</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;10,165</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Interest expense, net</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     70</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;531</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     157</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;&#160;1,112</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Foreign currency loss (gain)</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;1</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;43</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     2</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;40</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Realized and unrealized gain on convertible debt</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     --</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;(170)</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     --</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;(199)</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Severance</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;139</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;805</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     285</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;1,230</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Stock-based compensation</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;965</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;553</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     1,719</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;1,944</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Impairment loss on assets held for sale</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;1,638</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;--</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     1,638</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;--</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Investigation and review-related expenses</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;500</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;9,511</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     4,423</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;11,385</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Non-routine professional fees</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;1,017</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;--</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     1,017</td>&#13; &#13;    <td class="gnw_num">&#13; &#13;     &#160;--</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     Acquisition and merger expenses</td>&#13; &#13;    <td class="gnw_num_uline">&#13; &#13;     --</td>&#13; &#13;    <td class="gnw_num_uline">&#13; &#13;     &#160;42</td>&#13; &#13;    <td class="gnw_num_uline">&#13; &#13;     --</td>&#13; &#13;    <td class="gnw_num_uline">&#13; &#13;     &#160;&#160;162</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label_i10">&#13; &#13;     &#160;</td>&#13; &#13;    <td class="gnw_colhead">&#13; &#13;     &#160;</td>&#13; &#13;    <td class="gnw_colhead">&#13; &#13;     &#160;</td>&#13; &#13;    <td class="gnw_colhead">&#13; &#13;     &#160;</td>&#13; &#13;    <td class="gnw_colhead">&#13; &#13;     &#160;</td>&#13; &#13;   </tr>&#13; &#13;   <tr>&#13; &#13;    <td class="gnw_label">&#13; &#13;     <strong>Adjusted EBITDA</strong></td>&#13; &#13;    <td class="gnw_num_dline">&#13; &#13;     $&#160;(4,711)</td>&#13; &#13;    <td class="gnw_num_dline">&#13; &#13;     $&#160;(1,518)</td>&#13; &#13;    <td class="gnw_num_dline">&#13; &#13;     <money>$ (10,964)</money></td>&#13; &#13;    <td class="gnw_num_dline">&#13; &#13;     $&#160;(5,363)</td>&#13; &#13;   </tr>&#13; &#13; &#13; &#13; </table>&#13; &#13; '''

text = u"""Net loss from continuing operations for the six months ended June 30, 2013 was $32.1 million, compared to net loss from continuing operations of $31.3 million in the six months ended June 30, 2012"""
table_html =u'''<table class="MsoNormalTable" cellspacing="0" cellpadding="0" width="607" border="1"> <tbody> <tr> <td valign="top" width="301"> <p class="Newsreleasecopy"><b>Millions (except per share data)</b></p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center"><b>2Q 2010</b></p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center"><b>2Q 2009</b></p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center"><b>Change</b></p> </td> </tr>  <tr> <td valign="top" width="301"> <p class="Newsreleasecopy">Net earnings (loss)</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$14</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">($106)</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$120</p> </td> </tr>  <tr> <td valign="top" width="301"> <p class="Newsreleasecopy">Earnings (loss) per diluted share</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$0.07</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">($0.50)</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$0.57</p> </td> </tr>  <tr> <td valign="top" width="301"> <p class="Newsreleasecopy">Net sales</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$1,805</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$1,391</p> </td> <td valign="top" width="102"> <p class="Newsreleasecopy" align="center">$414</p> </td> </tr> </tbody> </table>'''
text = u"""This compares with a net loss of $106 million, or 50 cents per
share, on net sales from continuing operations of $1.4 billion for
the same period last year"""

table_html =u'''<table class="BlackBox" cellpadding="3" width="765" summary="A table comparing percentage of emergency department (ED) visits involving multiple or single drugs for selected illicit drugs and pharmaceuticals: 2009." border="0">&#13;   <caption class="FigTitle" align="top">Figure 1 Table. Percentage of Emergency Department (ED) Visits Involving Multiple or Single Drugs for Selected Illicit Drugs and Pharmaceuticals: 2009</caption>&#13;   <thead>&#13;   <tr>&#13;     <th class="revhead" scope="col" align="left">Illicit Drugs and Pharmaceuticals</th>&#13;     <th class="revhead" scope="col" nowrap="nowrap">Single Drug</th>&#13;     <th class="revhead" scope="col" nowrap="nowrap">Multiple Drugs</th>&#13;   </tr>&#13;   </thead>&#13;   &#13;   <tbody>&#13;   <tr valign="top">&#13;     <td scope="row" align="left">Cocaine</td>&#13;     <td align="center">32%</td>&#13;     <td align="center">68%</td>&#13;    </tr>&#13;    &#13;   <tr valign="top">&#13;     <td scope="row" align="left">Marijuana</td>&#13;     <td align="center">27%</td>&#13;     <td align="center">73%</td>&#13;    </tr>&#13;  &#13;   <tr valign="top">&#13;     <td scope="row" align="left">Heroin</td>&#13;     <td align="center">48%</td>&#13;     <td align="center">52%</td>&#13;    </tr>&#13;    &#13;   <tr valign="top">&#13;     <td scope="row" align="left">Narcotic Pain Relievers<a href="#figure1note*" name="backtofigure1note*">*</a></td>&#13;     <td align="center">37%</td>&#13;     <td align="center">63%</td>&#13;    </tr>&#13;    &#13;   <tr valign="top">&#13;     <td scope="row" align="left">Benzodiazepines<a href="#figure1note*">*</a></td>&#13;     <td align="center">21%</td>&#13;     <td align="center">79%</td>&#13;    </tr>&#13;    &#13;   <tr valign="top">&#13;     <td scope="row" align="left">Muscle Relaxants<a href="#figure1note*">*</a></td>&#13;     <td align="center">20%</td>&#13;     <td align="center">80%</td>&#13;    </tr>&#13; &#13;    <tr valign="top">&#13;     <td scope="row" align="left">Central Nervous System Stimulants<a href="#figure1note*">*</a></td>&#13;     <td align="center">33%</td>&#13;     <td align="center">67%</td>&#13;    </tr>&#13; </tbody>&#13; </table>&#13; &#13; '''
text =u"""For drug-related ED visits occurring in 2009, the likelihood of polydrug, also referred to as multiple drug, involvement varied depending on the type of drug involved. The majority of visits associated with use of cocaine or marijuana involved polydrug use (68 and 73 percent, respectively), whereas slightly more than half of heroin-related visits involved polydrug use (52 percent) (Figure 1). The majority of visits associated with the types of pharmaceuticals included in this report involved polydrug use (narcotic pain relievers: 63 percent, benzodiazepines: 79 percent, muscle relaxants: 80 percent, CNS stimulants: 67 percent)"""
table_html =u'''<table cellspacing="0" cellpadding="5" class="m1" width="100%">&#13;   <tr style="color: #666666;" align="center" width="25%"> &#13;     <td width="60%" style="text-align:left; border-right: 1px solid #E9F2F7;"><b class="m1">Application Development<br/> </b></td>&#13;        <td align="center" width="40%" style="border-right:1px solid #E9F2F7;">63</td>&#13; </tr>&#13; &#13;   <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Desktops/Software<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">57</td>&#13;   </tr>&#13;   <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Operating Systems<br/> </b></td>&#13;         <td align="center" style="border-right:1px solid #E9F2F7;">46</td>&#13;   </tr>&#13; &#13;   <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;"> &#13;     <td style="text-align:left ; border-right:1px solid #E9F2F7;"><b class="m1">Servers/Networking</b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">44</td>&#13;   </tr>&#13;   <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Database Management<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">44</td>&#13; &#13;   </tr>&#13;   <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Web Development</b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">42</td>&#13;   </tr>&#13;   <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">System Administration<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">40</td>&#13; &#13;   </tr>&#13;      <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Enterprise Applications<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">33</td>&#13;   </tr>  &#13;     <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">IT Outsourcing<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">32</td>&#13; &#13;   </tr> &#13;     <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">IT Security<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">28</td>&#13;   </tr>  &#13;     <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Quality Assurance Testing<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">25</td>&#13;   </tr>&#13; &#13;           <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;">  &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Web Services <br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">21</td>&#13;   </tr>   &#13;         <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Infrastructure Management<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">19</td>&#13;   </tr>    &#13;        <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;">  &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Data Center<br/> </b></td>&#13; &#13;     <td align="center" style="border-right:1px solid #E9F2F7;">19</td>&#13;   </tr>    &#13;         <tr style="color: #666666;" align="center"> &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Telco/Wireless/Mobile<br/> </b></td>&#13;     <td align="center" style="border-right:1px solid #E9F2F7;">17</td>&#13;   </tr>&#13;             <tr align="center" bgcolor="#E9F2F7" style="color: #666666; text-align:right;">  &#13;     <td style="text-align:left; border-right:1px solid #E9F2F7;"><b class="m1">Storage<br/> </b></td>&#13; &#13;     <td align="center" style="border-right:1px solid #E9F2F7;">16</td>&#13;   </tr>               &#13; &#13; </table>&#13;'''
text =u"""According to the IT employment survey, 63 percent of respondents had expertise in application development, while 56.9 percent had relevant skills in desktops and software. In comparison, less than 20 percent had expertise in storage, telecommunications/wireless/mobile, and data center and infrastructure management."""
doc = document.Document(0,0, text)
table = table.Table(1, 1, table_html, "test table")
doc.add_mention(0, "63 percent", 39,49)
#doc.add_mention(144056, u"\xa31.9bn", 178, 184)


doc.process_mention_context()
feature_extractor.extract_features_for_document(doc)
#rat  = table.aggregate_mentions['2,3'][3] # 0=sum, 1= avg, 2=diff, 3 = rat, 4= perc
#print(table.mentions.keys())

rat = table.mentions[18]
#rat = table.aggregate_mentions['4,5'][3]
mention = doc.mentions[0]
print(rat.absolute_value, rat.surface_form)
print(mention.absolute_value, mention.surface_form)
all_doc_tokens, all_doc_nps = doc.get_document_context()

table_tokens, table_nps = table.get_context_table()
tokens, nps = doc.get_mention_context(mention)

tokens_ = table.get_mention_context_words(rat)
nps_ = table.get_mention_noun_phrases(rat)

#print(table.row_meta)
print("mention scale", mention.features['scale'])
print("mention unit", mention.features['unit'])
print("table scale, unit",table.scale, table.unit)
print("table mention scale",table.get_mention_scale(rat))
print("table_mention unit",table.get_mention_unit(rat))


#print(utils.get_tokens_overlap(all_doc_nps, table_nps))
#print(all_doc_nps)
#print(table_nps)

print(utils.get_weighted_tokens_overlap(mention.start_offset, all_doc_tokens, table_tokens,5,0.1))
print(all_doc_tokens)
print(table_tokens)

print(utils.get_weighted_tokens_overlap(mention.start_offset, tokens, tokens_, 1, 0.025))
print("mention doc tokens", tokens)
print("mention table tokens", tokens_)
#print(utils.get_tokens_overlap(nps, nps_))
#print("mention doc nps:", nps)
#print("mention table nps:", nps_)

#print(utils.isYear('2011 '))

#print(sentence_processor.extract_noun_phrases('2011'))

#table.get_mention_context_words(mention)
#ention_table_context  = table.get_mention_context_words(mention)
#features['context_noun_phrases'] = table.get_mention_noun_phrases(mention)

#sentences_span = get_sentences_spans(doc)
#tokens, nps =sentence_processor.extract_noun_phrases(doc[sentences_span[0][0]: sentences_span[0][1]])
            
